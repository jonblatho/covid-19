var totalCasesButton=document.getElementById("total-cases"),newCasesButton=document.getElementById("new-cases"),activeCasesButton=document.getElementById("active-cases"),positivityRateButton=document.getElementById("positivity-rate"),dateMarkersButton=document.getElementById("date-markers");function changeChart(b,c){let a="button-selected";b!='date_markers'&&(totalCasesButton.classList.remove(a),newCasesButton.classList.remove(a),activeCasesButton.classList.remove(a),positivityRateButton.classList.remove(a)),b=='total'?totalCasesButton.classList.add(a):b=='new'?newCasesButton.classList.add(a):b=='active'?activeCasesButton.classList.add(a):b=='pos_rate'?positivityRateButton.classList.add(a):b=='date_markers'&&(dateMarkersButton.classList.contains(a)?(dateMarkersButton.classList.remove(a),dateMarkersButton.innerHTML="Date Markers Off",chart.options.annotation={}):(dateMarkersButton.classList.add(a),dateMarkersButton.innerHTML="Date Markers On",chart.options.annotation=markers)),b!='date_markers'?reloadChart(b,c):chart.update()}function reloadChart(a,b){chart.destroy(),a=='new'?chartType='bar':chartType='line',chart=new Chart(ctx,{type:chartType,options:{responsive:!0,aspectRatio:2,scales:{xAxes:[{type:'time',time:{tooltipFormat:'MMMM D, YYYY',unit:'month'}}],yAxes:[{ticks:{beginAtZero:!0}}]},tooltips:{mode:'index',intersect:!1}}}),chart.data.labels=chartLabels(a,b),chart.data.datasets=chartData(a,b),a=='total'?(chart.options.scales.xAxes[0].stacked=!0,chart.options.scales.yAxes[0].stacked=!0,chart.options.plugins={filler:{propagate:!1}}):a=='new'?(chart.options.scales.xAxes[0].stacked=!0,chart.options.scales.yAxes[0].stacked=!0,chart.options.plugins={}):a=='active'?(chart.options.scales.xAxes[0].stacked=!1,chart.options.scales.yAxes[0].stacked=!1):a=='pos_rate'&&(chart.options.scales.xAxes[0].stacked=!1,chart.options.scales.yAxes[0].stacked=!1),a=='pos_rate'&&(chart.options.scales.yAxes=[{id:'pos_rate',position:'left',ticks:{beginAtZero:!0},gridLines:{display:!0}},{id:'tests',position:'right',ticks:{beginAtZero:!0,lineWidth:0},gridLines:{display:!0}}],chart.options.scales.yAxes[0].ticks.userCallback=function(a,b,c){return a=a.toString(),a=a.split(/(?=(?:...)*$)/),a+'%'},chart.options.tooltips.callbacks={label:function(a,b){if(value=a.yLabel.toString(),a.datasetIndex==0)return'14-day Positivity Rate: '+value+'%';if(a.datasetIndex==1)return'14-day Average Daily Tests: '+value}}),restyleChartForDarkMode(),dateMarkersButton.classList.contains("button-selected")?chart.options.annotation=markers:chart.options.annotation={},chart.update()}function isDarkMode(){return!!(window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches)}function restyleChartForDarkMode(){if(isDarkMode()){chart.options.scales.xAxes[0].gridLines.color='rgba(255,255,255,0.1)',chart.options.scales.yAxes[0].gridLines.color='rgba(255,255,255,0.1)';try{chart.options.scales.xAxes[1].gridLines.color='rgba(255,255,255,0.1)',chart.options.scales.yAxes[1].gridLines.color='rgba(255,255,255,0.1)'}catch{}}else{chart.options.scales.xAxes[0].gridLines.color='rgba(0,0,0,0.1)',chart.options.scales.yAxes[0].gridLines.color='rgba(0,0,0,0.1)';try{chart.options.scales.xAxes[1].gridLines.color='rgba(0,0,0,0.1)',chart.options.scales.yAxes[1].gridLines.color='rgba(0,0,0,0.1)'}catch{}}}function reloadChartForTraitChange(a){'trait'=='darkMode'&&restyleChartForDarkMode(),chart.update()}