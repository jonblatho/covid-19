var totalCasesButton=document.getElementById("total-cases"),newCasesButton=document.getElementById("new-cases"),activeCasesButton=document.getElementById("active-cases"),positivityRateButton=document.getElementById("positivity-rate"),dateMarkersButton=document.getElementById("date-markers"),activeChartType,prefersDateMarkersOn;let selectedClassName="button-selected";activeChartType='total',prefersDateMarkersOn=!0;function changeChart(a,b){a!='date_markers'&&(totalCasesButton.classList.remove(selectedClassName),newCasesButton.classList.remove(selectedClassName),activeCasesButton.classList.remove(selectedClassName),positivityRateButton.classList.remove(selectedClassName)),a=='total'?totalCasesButton.classList.add(selectedClassName):a=='new'?(activeChartType='new',newCasesButton.classList.add(selectedClassName)):a=='active'?(activeChartType='active',activeCasesButton.classList.add(selectedClassName)):a=='pos_rate'?(activeChartType='pos_rate',positivityRateButton.classList.add(selectedClassName)):a=='date_markers'&&(dateMarkersButton.classList.contains(selectedClassName)?dateMarkersButton.classList.remove(selectedClassName):dateMarkersButton.classList.add(selectedClassName),prefersDateMarkersOn==!0?(prefersDateMarkersOn=!1,removeDateMarkers()):(prefersDateMarkersOn=!0,addDateMarkers())),a!='date_markers'?reloadChart(a,b):chart.update()}function reloadChart(a,b){chart.destroy(),a=='new'?chartType='bar':chartType='line',chart=new Chart(ctx,{type:chartType,options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{type:'time',min:'2020-04-01',time:{tooltipFormat:'MMMM D, yyyy',unit:'month'}},y:{min:0,display:'auto'},y_tests:{position:'right',display:'auto',min:0}},plugins:{annotation:markers},interaction:{mode:'index',intersect:!1}}}),chart.data.labels=chartLabels(a,b),chart.data.datasets=chartData(a,b),a=='total'||a=='new'?(chart.options.scales.x.stacked=!0,chart.options.scales.y.stacked=!0):(a=='active'||a=='pos_rate')&&(chart.options.scales.x.stacked=!1,chart.options.scales.y.stacked=!1),a=='pos_rate'&&(chart.options.scales={x:{type:'time',min:'2020-09-04',time:{tooltipFormat:'MMMM D, yyyy',unit:'month'}},y:{type:'linear',position:'left',min:0,grid:{display:!0},ticks:{callback:function(a,b,c){return a=a.toString(),a=a.split(/(?=(?:...)*$)/),a+'%'}}},y_tests:{type:'linear',position:'right',min:0,grid:{display:!0}}}),restyleChartForDarkMode(),window.innerWidth>600?addDateMarkers():removeDateMarkers(),chart.update()}function isDarkMode(){return!!(window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches)}function restyleChartForDarkMode(){if(isDarkMode())chart.options.scales.x.grid.color='rgba(255,255,255,0.1)',chart.options.scales.y.grid.color='rgba(255,255,255,0.1)',chart.options.scales.y.grid.color='rgba(255,255,255,0.1)';else{chart.options.scales.x.grid.color='rgba(0,0,0,0.1)',chart.options.scales.y.grid.color='rgba(0,0,0,0.1)',chart.options.scales.y.grid.color='rgba(0,0,0,0.1)';try{chart.options.scales.y_tests.grid.color='rgba(0,0,0,0.1)',chart.options.scales.y_tests.grid.color='rgba(0,0,0,0.1)'}catch{}}}function reloadChartForTraitChange(a){'trait'=='darkMode'&&restyleChartForDarkMode(),chart.update()}function addDateMarkers(){dateMarkersButton.classList.contains(selectedClassName)&&dateMarkersButton.classList.add(selectedClassName),chart.options.plugins.annotation=markers,chart.update()}function removeDateMarkers(){dateMarkersButton.classList.contains(selectedClassName)&&dateMarkersButton.classList.remove(selectedClassName),chart.options.plugins.annotation={},chart.update()}